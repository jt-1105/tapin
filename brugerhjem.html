<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>User Portal Skeleton</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <!-- Custom CSS -->
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="stylebruger.css">
</head>
<body>

<header>
  <!-------------------
          NAV BAR
  -------------------->
  <nav class="navbar navbar-light bg-light navbar-expand-lg">
    <div class="container-fluid">
      <!----------------
      OFFCANVAS TOGGLER
      ---------------->
      <button class="btn" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasMenu" aria-controls="offcanvasMenu">
        <i class="bi bi-list fs-2"></i>
      </button>

      <!------------------- 
      BRAND / LOGO
      --------------------->
      <a class="navbar-brand mx-auto mx-lg-0" href="brugerhjem.html">
        <img src="path/to/logo.png" alt="Logo" height="40">
      </a>

      <!-------------- 
      RIGHT ICONS GROUP
      --------------->
      <div class="d-flex ms-auto align-items-center">
        <!------- 
        SEARCH DROPDOWN
        -------->
        <div class="dropdown">
          <button class="btn" id="searchDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="bi bi-search fs-4"></i>
          </button>
          <div class="dropdown-menu dropdown-menu-end p-3" aria-labelledby="searchDropdown">
            <form class="d-flex" role="search">
              <input class="form-control me-2" type="search" placeholder="Search">
              <!-- styled via your style.css .btn-primary rules -->
              <button class="btn btn-primary" type="submit">Go</button>
            </form>
          </div>
        </div>

        <!-------------------- 
        PROFILE PICTURE BUTTON
        ---------------------->
        <a href="profil.html" class="ms-3">
          <img src="path/to/profile-pic.jpg" alt="Profil" height="40" class="rounded-circle">
        </a>
      </div>
    </div>
  </nav>

  <!------------
  OFFCANVAS MENU
  ------------>
  <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasMenu" aria-labelledby="offcanvasMenuLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="offcanvasMenuLabel">Menu</h5>
      <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
      <!-------------------
      NAV LINKS
      -------------------->
      <ul class="nav flex-column">
        <li class="nav-item"><a class="nav-link" href="brugerhjem.html">Hjem</a></li>
        <li class="nav-item"><a class="nav-link" href="sortiment.html">Sortiment</a></li>
        <li class="nav-item"><a class="nav-link" href="bartenderguide.html">Bartender Guide</a></li>
        <li class="nav-item"><a class="nav-link" href="resurser.html">Resurser</a></li>
      </ul>
    </div>
  </div>
</header>

<!-------
  TITEL
-------->
<section class="container text-center my-5">
  <h1>Welcome to Your Portal</h1>
  <div>
    <div>
      <h2>Opskrifter</h2>
      <a href="opskrifter.html">Din lære i lommen lige her!</a>
    </div>
    <div>
      <h2>Dine Opgaver</h2>
      <a href="dineopgaver.html">Lorem ipsum</a>
    </div>
  </div>
</section>

<!---------- 
Bootstrap JS 
----------->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!------------
FEED CONTAINER
------------>
<section id="feed" class="container my-5"></section>

<!------------
DUMMY DATABASE
-------------> 
 <script>
// 1) Load the posts.json file and stash globally
    fetch('posts.json')
      .then(res => res.json())
      .then(posts => {
        window._posts = posts;    // keep for later when adding comments
        renderFeed(posts);
      })
      .catch(err => console.error('Failed to load posts:', err));

    // 2) Turn each post into a card
    function renderFeed(posts) {
      const feed = document.getElementById('feed');
      feed.innerHTML = '';  // clear any existing content

      posts.forEach(post => {
        const card = document.createElement('div');
        card.className = 'card mb-4';

        // 2a) Build media HTML
        const mediaHtml = (post.media || []).map(m => {
          if (m.type === 'image') {
            return `<img src="${m.url}" class="card-img-top mb-2" alt="Post ${post.id} image">`;
          } else {
            return `<video class="w-100 mb-2" controls src="${m.url}"></video>`;
          }
        }).join('');

        // 2b) Build comments + add-comment form
        const commentsHtml = `
          <button class="btn btn-link px-0" 
                  data-bs-toggle="collapse" 
                  data-bs-target="#comments-${post.id}">
            Comments (${post.comments.length})
          </button>
          <div class="collapse mt-2" id="comments-${post.id}">
            <ul class="list-group list-group-flush" id="comments-list-${post.id}">
              ${post.comments.map(c => `
                <li class="list-group-item">
                  <strong>${c.author}</strong>
                  <span class="text-muted small"> — ${new Date(c.timestamp).toLocaleTimeString()}</span>
                  <p class="mb-0">${c.content}</p>
                </li>
              `).join('')}
            </ul>
            <form id="comment-form-${post.id}" class="mt-3">
              <textarea class="form-control mb-2" 
                        rows="2" 
                        placeholder="Write a comment…" 
                        required></textarea>
              <button type="submit" class="btn btn-primary btn-sm">
                Post Comment
              </button>
            </form>
          </div>
        `;

        // 2c) Assemble the card
        card.innerHTML = `
          <div class="card-body">
            <h5 class="card-title">${post.author}</h5>
            <h6 class="card-subtitle mb-2 text-muted">
              ${new Date(post.timestamp).toLocaleString()}
            </h6>
            <p class="card-text">${post.content}</p>
            ${mediaHtml}
            ${commentsHtml}
          </div>
        `;

        feed.appendChild(card);

        // 2d) Wire up the “add comment” form
        attachCommentHandler(post.id);
      });
    }

    // 3) Attach submit listener for one post’s comment form
    function attachCommentHandler(postId) {
      const form = document.getElementById(`comment-form-${postId}`);
      form.addEventListener('submit', function(e) {
        e.preventDefault();                 // don’t reload the page
        const textarea = form.querySelector('textarea');
        const text = textarea.value.trim();
        if (!text) return;                 // ignore empty
        addCommentToPost(postId, text);
        textarea.value = '';               // clear box
      });
    }

    // 4) Create the comment object, update in-memory array + DOM
    function addCommentToPost(postId, content) {
      // Build comment
      const comment = {
        id: Date.now(),                   // simple unique ID
        author: 'You',                    // fixed username; change as desired
        content,
        timestamp: new Date().toISOString()
      };

      // 4a) Append to our in-memory data
      const post = window._posts.find(p => p.id === postId);
      post.comments.push(comment);

      // 4b) Append to the comments list in the DOM
      const list = document.getElementById(`comments-list-${postId}`);
      const li = document.createElement('li');
      li.className = 'list-group-item';
      li.innerHTML = `
        <strong>${comment.author}</strong>
        <span class="text-muted small"> — ${new Date(comment.timestamp).toLocaleTimeString()}</span>
        <p class="mb-0">${comment.content}</p>
      `;
      list.appendChild(li);

      // 4c) Update the Comments (…) button text
      const btn = document.querySelector(`[data-bs-target="#comments-${postId}"]`);
      btn.textContent = `Comments (${post.comments.length})`;
    }
    </script>
    
<!-------
CUSTOM JS
-------->    
    <script src="script.js"></script>
    
</body>
</html>
